<section class="nimble-selector__root">
	<div class="nimble-selector__header">
		<i class="fa-solid fa-hat-wizard nimble-selector__header-icon"></i>
		<div class="nimble-selector__header-info">
			<h2 class="nimble-selector__header-title">Spell Selection</h2>
			<p class="nimble-selector__header-subtitle">{{className}} &mdash; Max Tier {{maxTier}}</p>
		</div>
	</div>

	{{!-- School Filter --}}
	<div class="nimble-selector__filter-bar">
		<button type="button"
				class="nimble-selector__filter-btn {{#unless activeSchool}}nimble-selector__filter-btn--active{{/unless}}"
				data-action="filterSchool" data-school="">
			All
		</button>
		{{#each schools}}
			<button type="button"
					class="nimble-selector__filter-btn {{#if this.active}}nimble-selector__filter-btn--active{{/if}}"
					data-action="filterSchool" data-school="{{this.id}}">
				<i class="{{this.icon}} nimble-selector__school-icon--{{this.id}}"></i>
				{{this.label}}
			</button>
		{{/each}}
	</div>

	{{!-- Tier Filter --}}
	<div class="nimble-selector__category-tabs">
		<button type="button"
				class="nimble-selector__category-tab {{#unless activeTier}}nimble-selector__category-tab--active{{/unless}}"
				data-action="filterTier" data-tier="">
			All Tiers
		</button>
		{{#each availableTiers}}
			<button type="button"
					class="nimble-selector__category-tab {{#if this.active}}nimble-selector__category-tab--active{{/if}}"
					data-action="filterTier" data-tier="{{this.tier}}">
				Tier {{this.tier}}
			</button>
		{{/each}}
	</div>

	{{!-- Spell List --}}
	<div class="nimble-selector__scroll-area">
		{{#if filteredSpells.length}}
			<div class="nimble-selector__card-grid">
				{{#each filteredSpells}}
					<div class="nimble-selector__card {{#if this.selected}}nimble-selector__card--selected{{/if}} {{#if this.alreadyOwned}}nimble-selector__card--owned{{/if}}"
						 data-action="toggleSpell" data-uuid="{{this.uuid}}">
						<input type="checkbox" class="nimble-selector__card-checkbox"
							   {{#if this.selected}}checked{{/if}}
							   {{#if this.alreadyOwned}}disabled{{/if}} />
						<img class="nimble-selector__card-img" src="{{this.img}}" alt="{{this.name}}" />
						<div class="nimble-selector__card-content">
							<div class="nimble-selector__card-name">{{this.name}}</div>
							<div class="nimble-selector__card-meta">
								<i class="{{this.schoolIcon}} nimble-selector__school-icon--{{this.school}}"></i>
								{{this.schoolLabel}}
								<span class="nimble-selector__spell-tier-badge nimble-selector__spell-tier-badge--{{this.tierClass}}">
									{{this.tierLabel}}
								</span>
							</div>
						</div>
						{{#if this.alreadyOwned}}
							<span class="nimble-selector__card-owned-tag">Owned</span>
						{{/if}}
					</div>
				{{/each}}
			</div>
		{{else}}
			<div class="nimble-selector__empty">No spells match the current filters.</div>
		{{/if}}
	</div>

	<div class="nimble-selector__actions">
		<button type="button" class="nimble-selector__btn" data-action="cancel">
			<i class="fa-solid fa-xmark"></i> Cancel
		</button>
		<button type="button" class="nimble-selector__btn" data-action="confirm"
				{{#unless hasSelection}}disabled{{/unless}}>
			<i class="fa-solid fa-check"></i> Grant Selected ({{selectedCount}})
		</button>
	</div>
</section>
